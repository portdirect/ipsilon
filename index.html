<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Ipsilon by portdirect</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Ipsilon</h1>
      <h2 class="project-tagline">Ipsilon Federated Identity Provider</h2>
      <a href="https://github.com/portdirect/ipsilon" class="btn">View on GitHub</a>
      <a href="https://github.com/portdirect/ipsilon/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/portdirect/ipsilon/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="ipsilon---identity-provider" class="anchor" href="#ipsilon---identity-provider" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Ipsilon - Identity Provider</h1>

<p>The Ipsilon project implements an <a href="http://en.wikipedia.org/wiki/Identity_provider">Identity Provider</a>
that is easy to use and configure. And it aims at providing installation scripts
for applications that can use an Apache fronted to perform user authentication.</p>

<p>An IdP server allows users to authenticate against any identity provider
whether that is a corporate LDAP server or even just local files or custom
pluggable modules and allows applications to authenticate users while being
completely agnostic of what authentication infrastructure is being used.</p>

<p>Applications can currently use the <a href="http://en.wikipedia.org/wiki/Security_Assertion_Markup_Language">SAML2</a>
protocol to talk to the Ipsilon identity provider, an application that uses
SAML is called a Service Provider.</p>

<p>Ipsilon uses the <a href="http://lasso.entrouvert.org">LASSO</a> libraries and Python
bindings to implement SAML support.</p>

<h1>
<a id="ipsilon-server-installation" class="anchor" href="#ipsilon-server-installation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Ipsilon Server Installation</h1>

<p>The Ipsilon server can be easily installed by simply running the
<code>ipsilon-server-install</code> command.</p>

<p>Prerequisites:</p>

<ul>
<li>An Apache server with SSL configured</li>
<li>A keytab if Kerberos authentication is desired</li>
<li>An unprivileged user to run the Ipsilon code (defaults to 'ipsilon')</li>
</ul>

<p>Currently there are only two available authentication modules, GSSAPI and
PAM. The Kerberos module uses <code>mod_auth_gssapi</code> (which it will configure for
you at install time), the Pam module simply uses the PAM stack with a default service
name set to <code>ipsilon</code>.</p>

<p><strong>NOTE</strong> The PAM module is invoked as an unprivileged user so if you are using the
pam_unix plugin to authenticate users you'll find out that authentication does
not work properly. Please use a different PAM module, like <code>pam_sss</code>, <code>pam_ldap</code>,
etc..</p>

<p>Before you run the install script make sure to create an administrative user
that can be authenticated either via PAM or GSSAPI. The default name the
installation script expects is <code>admin</code> but that can be changed with the command
line option named <code>--admin-user</code></p>

<p>The hostname used is the system host name, if you can't set the system hostname
to a fully qualified name, used the <code>--hostname</code> option to pass the desired fully
qualified name for the IdP. It is important to use the correct name as this
name is referenced and resolved by remote clients.</p>

<p>Other options are available by running <code>ipsilon-server-install --help</code></p>

<p>To install a server that allow both GSSAPI (Kerberos) and PAM authentication
use:</p>

<pre><code>$ ipsilon-server-install --gssapi=yes --pam=yes
</code></pre>

<p>This command will generate a default instance called <code>idp</code> (you can change the
default name using the <code>--instance</code> switch). Multiple instance can be installed
in parallel, each wit a different name.</p>

<p>Instances are configured to be available at https://hostname/instance</p>

<p>So for a server called ipsilon.example.com, using the default installation
options the IdP will be available at <a href="https://ipsilon.example.com/idp/">https://ipsilon.example.com/idp/</a></p>

<p>The install script expects to find the keytab in /etc/httpd/conf/http.keytab</p>

<p><strong>NOTE:</strong> If you are installing Ipsilon in a <a href="http://www.freeipa.org">FreeIPA</a>
environment you can use the --ipa switch to simplify the deployment.
Using the <code>--ipa</code> switch will allow the use of your IPA Kerberos administrative
credentials to automatically provision a keytab for the HTTP service if one is
not available yet.  You will likely want to use the <code>--admin-user</code> option to
specify the full principal of the user who will administer Ipsilon.
For example to use the FreeIPA admin user for the EXAMPLE.COM realm, you would use:</p>

<pre><code>$ ipsilon-server-install --ipa --admin-user admin@EXAMPLE.COM
</code></pre>

<p>Once the script has successfully completed the installation, restart the Apache
HTTPD server to activate it.</p>

<p>Use your <code>admin</code> user to connect to the Web UI and perform additional
administration tasks.</p>

<h1>
<a id="ipsilon-clients-configuration" class="anchor" href="#ipsilon-clients-configuration" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Ipsilon Clients configuration</h1>

<p>Ipsilon clients can be quickly configured running the provided
<code>ipsilon-client-install</code> command.</p>

<p>Prerequisites:</p>

<ul>
<li>An Apache server with SSL configured</li>
<li>The <a href="https://code.google.com/p/modmellon/">mod_mellon</a> authentication module for Apache</li>
<li>A previously installed SAML IdP server (like Ipsilon itself)</li>
</ul>

<p>The default configuration for the client will install a configuration in Apache
that will authenticate via the IdP any attempt to connect to the location named
'/protected', a test file is returned at that location.</p>

<p>In order to successfully install a client 2 steps are necessary:</p>

<ol>
<li>Prepare the client configuration and SAML metadata file.</li>
</ol>

<p>To generate a valid metadata file and configuration it is necessary to provide
the IdP metadata file  to the installer, it is also useful to decide upfront
where the application to be protected is located.</p>

<p>Let's assume the IdP is a standard install of the Ipsilon server on the server
name ipsilon.example.com, and the client to be installed is called
media.exmple.com with a wiki application located under /wiki</p>

<p>The following command will configure the server and generate the metadata file:</p>

<pre><code> $ ipsilon-client-install \
 --saml-idp-metadata http://ipsilon.example.com/idp/saml2/metadata \
 --saml-auth /wiki
</code></pre>

<p>Use --help to explore all the possible options.</p>

<ol>
<li>Upload the generated metadata file to the IdP.</li>
</ol>

<p>Once the script has successfully completed installation it will create a
few files in /etc/httpd/saml2/<code>hostname</code>. There you will find a (self-signed)
certificate and a private key used to authenticate with the IdP and 2 metadata
files, one of which is called 'metadata.xml'</p>

<p>Log in with the 'admin' account to the Ipsilon server and go to:
 Administration -&gt; Identity Providers -&gt; saml2 -&gt; Administer
Click the 'Add New' button and add a new entry uploading the metadata.xml file
just generated.</p>

<p>Once this is done, test that the authentication is working by going to the
application server url: <a href="https://media.example.com/wiki">https://media.example.com/wiki</a>
The SP should redirect you to the IdP server, perform authentication, and then
redirect you automatically back to the application server where you should find
yourself authenticated.</p>

<p>NOTE: read modmellon's documentation to find out how to pass additional
authorization data to the application. For simple authentication the application
should expect a user have been authenticate if it finds a non empty 'REMOTE_USER'
environment variable in the incoming requests.</p>

<p>ALSO NOTE: If your application is already SAML aware you can simply run the
install script with the --saml-no-httpd option. This will generate the
certificates and the metadata.xml file you need to provide to the application
and the IdP in the current directory.</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/portdirect/ipsilon">Ipsilon</a> is maintained by <a href="https://github.com/portdirect">portdirect</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
